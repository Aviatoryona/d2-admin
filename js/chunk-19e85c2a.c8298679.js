(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19e85c2a"],{"7ed9":function(e,t,i){"use strict";var r=i("98b5"),a=i.n(r);a.a},"98b5":function(e,t,i){},b1ca:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d2p-cropper-uploader",class:{"is-disabled":e.disabled}},[i("div",{staticClass:"image-list"},[e._l(e.list,(function(t,r){return i("div",{key:r,staticClass:"image-item"},[i("el-image",{staticClass:"image",attrs:{src:t.dataUrl?t.dataUrl:t.url,"data-src":t.url,"preview-src-list":e._urlList,fit:"contain"}}),e.disabled?e._e():i("div",{staticClass:"delete"},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.removeImage(r,t)}}})]),"uploading"===t.status?i("div",{staticClass:"status-uploading"},[i("el-progress",{attrs:{type:"circle",percentage:t.progress,width:70}})],1):"done"===t.status?i("div",{staticClass:"status-done"},[i("i",{staticClass:"el-icon-upload-success el-icon-check"})]):e._e()],1)})),e.limit<=0||e.limit>e.list.length?i("div",{staticClass:"image-item image-plus",on:{click:e.addNewImage}},[i("i",{staticClass:"el-icon-plus cropper-uploader-icon"})]):e._e()],2),i("d2p-cropper",{ref:"cropper",attrs:{title:e.title,cropperHeight:e.cropperHeight,dialogWidth:e.dialogWidth,accept:e.accept,uploadTip:e.uploadTip,maxSize:e.maxSize,cropper:e.cropper,output:"all"},on:{done:e.cropComplete}})],1)},a=[],s=(i("a434"),i("b0c0"),i("a9e3"),i("96cf"),i("1da1")),l=i("b85c"),n=i("c80b"),o=i("0e05"),u=i("0e00"),c={name:"d2p-cropper-uploader",mixins:[u["a"].inputBase],components:{D2pCropper:n["default"]},props:{value:{type:[String,Array]},type:{type:String,default:"cos"},uploadTip:{type:String},title:String,cropperHeight:{type:[String,Number]},dialogWidth:{type:[String,Number],default:"50%"},maxSize:{type:Number,default:5},limit:{type:Number,default:1},accept:{type:String,default:".jpg, .jpeg, .png, .gif, .webp"},cropper:{type:Object},uploader:{type:Object}},data:function(){return{index:void 0,list:[]}},watch:{value:function(e){this.$emit("change",e),e!==this.emitValue&&this.initValue(e)}},created:function(){this.emitValue=this.value,this.initValue(this.value)},computed:{_urlList:function(){var e=[];if(this.list){var t,i=Object(l["a"])(this.list);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.push(r.url)}}catch(a){i.e(a)}finally{i.f()}}return e}},methods:{initValue:function(e){var t=[];if(null==e||""===e)return t;if("string"===typeof e)t.push({url:e,status:"done"});else{var i,r=Object(l["a"])(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;t.push({url:a,status:"done"})}}catch(s){r.e(s)}finally{r.f()}}this.$set(this,"list",t)},addNewImage:function(){this.disabled||(this.index=void 0,this.$refs.cropper.clear(),this.$refs.cropper.open())},removeImage:function(e,t){this.list.splice(e,1),this.emit()},cropComplete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var r,a,s,l,n,o,u,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r=e.blob,a=e.dataUrl,s=e.file,l={url:void 0,dataUrl:a,status:"uploading",progress:0},n=function(e){l.progress=e.percent},o=function(e){l.status="error",l.message="文件上传出错:"+e.message,console.log(e)},console.log("blob:",r),u={file:r,fileName:s.name,onProgress:n,onError:o},t.list.push(l),i.next=11,t.doUpload(u);case 11:c=i.sent,l.url=c.url,l.status="done",t.emit();case 15:case"end":return i.stop()}}),i)})))()},doUpload:function(e){var t=this;return e.config=this.uploader,this.getUploader().then((function(i){return i.upload(e).then((function(e){return null!=t.suffix&&(e.url+=t.suffix),e}))}))},getUploader:function(){var e=this.type;return null!=this.uploader&&null!=this.uploader.type&&(e=this.uploader.type),o["a"].getUploader(e)},emit:function(){var e,t=[],i=Object(l["a"])(this.list);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(null!=r.status&&"done"!==r.status)return;"string"===typeof r?t.push(r):t.push(r.url)}}catch(s){i.e(s)}finally{i.f()}var a=t;1===this.limit&&(a=t[0]),this.emitValue=a,this.$emit("input",a)}}},p=c,d=(i("7ed9"),i("2877")),f=function(e){e.options.__source="node_modules/d2p-extends/src/file-uploader/lib/cropper-uploader.vue"},h=f,g=Object(d["a"])(p,r,a,!1,null,null,null);"function"===typeof h&&h(g);t["default"]=g.exports}}]);